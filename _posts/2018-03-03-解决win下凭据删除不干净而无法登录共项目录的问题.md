---
layout: post
title: 2018-03-03-解决win下凭据删除不干净而无法登录共项目录的问题
key: 20180303
tags: 凭据 账号 资源 重连接 WIN 域
modify_date: 2018-03-03
---



# 解决win下凭据删除不干净而无法登录共项目录的问题

说明：
* 本文发布于: [gitee](http://freelogic.gitee.io/webpost/),[github](https://freelogic.github.io/),[博客园](http://www.cnblogs.com/taichu/)
* 转载和引用请指明原作者和连接及出处.

正文：
* 问题及其分析（较复杂，慢慢看）
  * win系统用的较多，公司一般会用Windows的域来管控资源，包括域账号和域机器(PC或服务器等硬件)。IT人员作为admin管理员来管控域，普通员工被给予1个域账号。
  * 员工一般喜欢用本机账号登录PC或笔记本，但当访问域资源时(比如用共享目录形式访问某服务器资源，举例：\\10.29.25.21)，此时会弹出框要求输入域账号及密码，然后才能访问域资源。
  * 但问题是有时候，会用多个域或本机账号登录，甚至某些账号还在登录后映射了固定盘符到域中某服务器的某共享目录等，这会留下win系统层面的凭据，如果想要用另一个win账号再次登录原先的域资源，会提示“已经用其他账号登录了资源，需要先退出原先账号，才能以新账号重新登录”。
  * 至此，也没问题，一般我们到控制面板中“凭据管理”里删除老凭据，然后下一次登录域资源，就会直接询问你用哪个新的账号密码登录，而不会先提示说已经用用老密码默认登录了资源，请先退出。
  * 现在问题来了，有时候我们无法将凭据删除干净！！！比如删除了老的“\\10.29.25.21\”的所有已经登录的账号的凭据，但下次登录，win仿佛依然会自动用某个老账号登录，凭据似乎没有被删除！

* 解决
  * 查了较多资料，始终找不到当凭据删除失败后，如何将它剔除干净的办法，最终发现还是只能使用“net use”命令，最有效。
  * [x] 步骤1 : 打开cmd命令行界面
  * [x] 步骤2:  用如下命令先删除凭据，再查看当前凭据连接到资源的情况；注意必须将同一个IP下的所有凭据都删除干净！
```
net use \\10.29.25.21\ipc$ /delete
net use \\10.29.25.21\build /delete
net use \\10.29.25.21\zhangsan /delete
net use 
```
  * [x] 步骤3:  用如下命令添加连接到资源的新账号凭据。
```
提示: 
1. "domainname"是域名，没有可不加，访问域资源都用域账号，则需加域名；
2. "account333"是账号名，123456是密码，如用‘*’代替密码，则会交互式的要求输入密码;
3.‘/user’是“net use”命令的参数，和‘/delete’类似。
4. 不加参数，直接“net use”就是查看当前凭据和域资源和账号的绑定连接情况；
5. “IPC$”是为了直接使用IP地址登录服务器，比如“\\123.123.123.123\”时候，其实就是绑定到IPC$

net use \\10.29.25.21\IPC$ 123456 /use:domainname\account333
net use \\10.29.25.21\build 123456 /use:account222
net use   
```
* 结论
  * 一般公司有域资源和非域资源两种，而且经常混用；
  * 某本地PC或笔记本一般也会用多个账号登录本机或远端其他域账号；
  * 域账号在登录本机后，随后访问域资源就不再需要输入域账号了。而如果用本机账号登录本机，随后访问域资源就额外需要提示输入域账号；
  * 如果域账号或本机账号有变化，有问题，密码无效，或者小号等等情况。出问题的老账号如果绑定了某域资源，它的凭据很可能被WIN记录，而且控制面板里面删除不干净！！！
  * 此时只能用“net use”命令解决问题。
